---
icon: akar-icons:file
date: 2026-1-17
order: 11
category:
  - NestJS
---

# 查询和参数

## 基础查询 where

参数放在where 里面

```ts
await this.userRepository.findOne({where: [{phone}]})
```

## 添加查询关系 连表查询 relations

```ts
 const user = await this.userRepository.findOne({
  where: {phone},
  relations: ['role'],
})
```

## 分页查询 skip take

```ts
const data = await this.giftRepository.find({
  where: {name: ILike(`%${param.name}%`)},
  order: {id: 'ASC'},
  take: param.pageSize,
  skip: (param.pageNum - 1) * param.pageSize,
})
```

## 模糊查询 ILike

```ts
const data = await this.giftRepository.find({
  where: {name: ILike(`%${param.name}%`)},
})
```

## 排序 order

```ts
const data = await this.giftRepository.find({
  where: {name: ILike(`%${param.name}%`)},
  order: {id: 'ASC'},
})
```

## createQueryBuilder  自定义更高级的查询

```ts
const data = await this.lotteryChancesRepository
  .createQueryBuilder('lotteryChances')
  .where('lotteryChances.user_id = :id', {id})
  .getOne()
```
